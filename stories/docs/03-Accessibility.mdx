import { Meta } from '@storybook/blocks';

<Meta title="Documentation/03-Accessibility" />

# Accessibility

Shoelace is designed with accessibility in mind. All components follow WCAG 2.1 Level AA guidelines and are built to be inclusive by default.

## Core Principles

### Keyboard Navigation
All interactive components are fully keyboard accessible:

- **Tab** - Navigate between focusable elements
- **Shift + Tab** - Navigate backwards
- **Enter/Space** - Activate buttons and controls
- **Arrow Keys** - Navigate within components (menus, tabs, etc.)
- **Escape** - Close dialogs, dropdowns, and other overlays
- **Home/End** - Jump to first/last item in lists

### Screen Readers
Components provide proper semantic HTML and ARIA attributes:

- Meaningful labels and descriptions
- Proper roles and states
- Live regions for dynamic content
- Hidden content properly managed

### Focus Management
- Visible focus indicators on all interactive elements
- Logical focus order
- Focus trapping in modals and dialogs
- Proper focus restoration when closing overlays

## ARIA Support

All components use appropriate ARIA attributes:

\`\`\`html
<sl-button aria-label="Close dialog">
  <sl-icon name="x"></sl-icon>
</sl-button>

<sl-input
  label="Email"
  aria-describedby="email-help"
>
</sl-input>
<div id="email-help">We'll never share your email</div>

<sl-dialog label="Confirm Action" aria-modal="true">
  Are you sure?
</sl-dialog>
\`\`\`

## Color Contrast

All color combinations meet WCAG AA standards:

- **Normal text**: Minimum contrast ratio of 4.5:1
- **Large text**: Minimum contrast ratio of 3:1
- **UI components**: Minimum contrast ratio of 3:1

The design token system ensures proper contrast in both light and dark themes.

## Form Accessibility

### Labels
Always provide labels for form controls:

\`\`\`html
<sl-input label="Email" type="email"></sl-input>

<sl-button aria-label="Search">
  <sl-icon name="search"></sl-icon>
</sl-button>

<sl-input type="email"></sl-input>
\`\`\`

### Error States
Provide clear error messages:

\`\`\`html
<sl-input
  label="Email"
  type="email"
  required
  aria-invalid="true"
  aria-describedby="email-error"
>
</sl-input>
<div id="email-error" role="alert">
  Please enter a valid email address
</div>
\`\`\`

### Required Fields
Indicate required fields clearly:

\`\`\`html
<sl-input
  label="Email"
  type="email"
  required
  help-text="Required"
>
</sl-input>
\`\`\`

## Interactive Components

### Dialogs & Modals
- Focus is trapped within the dialog
- First focusable element receives focus on open
- Focus returns to trigger element on close
- Escape key closes the dialog
- Background content is properly hidden

\`\`\`html
<sl-dialog label="Important Message">
  <p>This dialog traps focus and manages accessibility automatically.</p>
  <sl-button slot="footer">Close</sl-button>
</sl-dialog>
\`\`\`

### Dropdowns & Menus
- Arrow key navigation
- Type-ahead search
- Proper roles (menu, menuitem)
- Active descendant management

\`\`\`html
<sl-dropdown>
  <sl-button slot="trigger" caret>Menu</sl-button>
  <sl-menu>
    <sl-menu-item>Option 1</sl-menu-item>
    <sl-menu-item>Option 2</sl-menu-item>
  </sl-menu>
</sl-dropdown>
\`\`\`

### Tabs
- Arrow key navigation
- Automatic or manual activation
- Proper ARIA roles (tablist, tab, tabpanel)

\`\`\`html
<sl-tab-group>
  <sl-tab slot="nav" panel="general">General</sl-tab>
  <sl-tab slot="nav" panel="advanced">Advanced</sl-tab>

  <sl-tab-panel name="general">General settings</sl-tab-panel>
  <sl-tab-panel name="advanced">Advanced settings</sl-tab-panel>
</sl-tab-group>
\`\`\`

## Testing for Accessibility

### Automated Testing
This design system includes automated accessibility testing:

\`\`\`bash
# Run accessibility tests
npm run test
\`\`\`

The test runner uses axe-core to check for:
- Missing labels
- Insufficient color contrast
- Improper ARIA usage
- Keyboard accessibility issues

### Manual Testing Checklist

1. **Keyboard Navigation**
   - [ ] Can you reach all interactive elements with Tab?
   - [ ] Can you activate controls with Enter/Space?
   - [ ] Can you close overlays with Escape?

2. **Screen Reader**
   - [ ] Are all images properly labeled?
   - [ ] Do form controls have proper labels?
   - [ ] Are error messages announced?
   - [ ] Is dynamic content announced?

3. **Visual**
   - [ ] Is text readable at different zoom levels?
   - [ ] Do focus indicators have sufficient contrast?
   - [ ] Is color alone not used to convey information?

4. **Motion**
   - [ ] Can animations be reduced/disabled?
   - [ ] Are transitions appropriate for users with motion sensitivity?

## Best Practices

### Do's
- ✓ Use semantic HTML elements
- ✓ Provide text alternatives for images and icons
- ✓ Ensure sufficient color contrast
- ✓ Make all functionality keyboard accessible
- ✓ Use proper heading hierarchy
- ✓ Test with real assistive technologies
- ✓ Include skip links for navigation

### Don'ts
- ✗ Don't rely on color alone to convey meaning
- ✗ Don't create keyboard traps
- ✗ Don't use vague link/button text like "click here"
- ✗ Don't disable zoom or text sizing
- ✗ Don't auto-play audio or video
- ✗ Don't use animations that could trigger seizures

## Resources

- [WCAG 2.1 Guidelines](https://www.w3.org/WAI/WCAG21/quickref/)
- [ARIA Authoring Practices](https://www.w3.org/WAI/ARIA/apg/)
- [WebAIM Resources](https://webaim.org/resources/)
- [Shoelace Accessibility Docs](https://shoelace.style/resources/accessibility)

## Testing Tools

- [axe DevTools](https://www.deque.com/axe/devtools/) - Browser extension for accessibility testing
- [NVDA](https://www.nvaccess.org/) - Free screen reader for Windows
- [JAWS](https://www.freedomscientific.com/products/software/jaws/) - Popular screen reader
- [VoiceOver](https://www.apple.com/accessibility/voiceover/) - Built-in macOS/iOS screen reader
- [Lighthouse](https://developers.google.com/web/tools/lighthouse) - Automated auditing tool
